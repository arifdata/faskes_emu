{% extends 'laporan/base.html' %}
{% block content %}
	  <br>
	  <div class="row">
	  <div class="col-lg-6 col-xs-12">
      {% if labels_kunjungan and data_kunjungan %}
      <div id="kunjunganChart"></div>
      {% else %}
      <div><h3 align="center">Belum ada data kunjungan bulan {{bln}} {{thn}}.</h3></div>
      {% endif %}
      <br>
      </div>

      <div class="col-lg-6 col-xs-12">
      {% if labels_penyakit and data_penyakit %}
      <div id="penyakitPieChart"></div>
      {% else %}
      <div><h3 align="center">Belum ada data penyakit bulan {{bln}} {{thn}}.</h3></div>
      {% endif %}
      <br>
      </div>

      <div class="col-lg-6 col-xs-12">
      {% if labels_obat_terbanyak and data_obat_terbanyak %}
      <div id="obatBarChart"></div>
      {% else %}
      <div><h3 align="center">Belum ada data obat bulan {{bln}} {{thn}}.</h3></div>
      {% endif %}
      <br>
      </div>

      <div class="col-lg-6 col-xs-12">
      {% if peresep_data %}
	  <div id="penulisResep"></div>
	  {% else %}
	  <div><h3 align="center">Belum ada data peresep {{bln}} {{thn}}.</h3></div>
	  {% endif %}
		<br>
      </div>

      <div class="col-lg-12 col-xs-12">
      {% if addr %}
      <p>Public IP (<u>{{ addr }}:8000</u>)</p>
      {% else %}
      <p><i>Not connected to any network</i></p>
      {% endif %}
      <br>
      <br>
      </div>
            
      </div>


  <script type="text/javascript">
  {% if peresep_data %}
      var opsi_peresep = {
      series: [
      {
        data: {{ peresep_data|safe }}
      }
    ],
      legend: {
      show: false
    },
    chart: {
      height: 300,
      type: 'treemap'
    },
    plotOptions: {
        treemap: {
            distributed: true
        }
    },
    colors: [
        '#96CEB4',
        '#D9534F',
        '#FFAD60',
        '#7900FF',
        '#F05454',
        '#D06224',
    ],
    legend: {
        show: true,
        position: 'bottom'
    },
    title: {
      text: 'Peresep Bulan Ini',
      align: 'center'
    }
    };

    var peresep_chart = new ApexCharts(document.querySelector("#penulisResep"), opsi_peresep);
    peresep_chart.render();

    {% else %}
    {% endif %}

  
    {% if labels_kunjungan and data_kunjungan %}
    var opsi_kunjungan = {
      series: [{
        name: "Lembar Resep",
        data: {{ data_kunjungan|safe }}
    }],
      chart: {
      //height: 350,
      type: 'line',
      zoom: {
        enabled: true
      }
    },
    dataLabels: {
      enabled: true
    },
    stroke: {
      curve: 'straight',
      width: 2
    },
    title: {
      text: 'Jumlah R/ Bulan Ini',
      align: 'center'
    },
    subtitle: {
        text: "Rata-rata: {{ rerata_kunjungan|floatformat:0 }}",
        align: 'right'
    },
    markers:{
        size: 2,
        shape: "circle"
    },
    colors: ["#D96098"],
    grid: {
      borderColor: '#325288',
      xaxis: {
        lines: {
            show: true
        }
      },
      yaxis: {
        lines: {
            show: true
        }
      },
      row: {
        colors: ['#24A19C'],
        opacity: 0.1
      },
      column: {
        colors: ['#24A19C'],
        opacity: 0.2
      },
    },
    yaxis: {
        show: true,
        showAlways: true,
        min: -1,
        title: {
            text: "Jumlah Lembar",
            rotate: -90,
        },
    },
    xaxis: {
      min: 0,
      categories: {{ labels_kunjungan|safe }},
      labels: {
        show: true,
        rotate: -45,
        rotateAlways: true
      },
      title:{
        text: "Tanggal",
        style: {
            fontSize: '12px'
        },
      },
    }
    };

    var kunjungan_chart = new ApexCharts(document.querySelector("#kunjunganChart"), opsi_kunjungan);
    kunjungan_chart.render();

    {% else %}
    // belum ada data kunjungan
    {% endif %}

    {% if labels_penyakit and data_penyakit %}
    var opsi_penyakit = {
      series: {{ data_penyakit|safe }},
      chart: {
      type: 'donut',
    },
    colors: [
            '#FF0075',
            '#172774',
            '#77D970',
            '#EEEEEE',
            '#F43B86',
            '#FFE459',
            '#FC92E3',
            '#22B9CA',
            '#D22779',
            '#612897',
            '#FF6363',
            '#E99497',
            '#FF449F',
            '#CF0000',
            '#C0E218',
            '#59886B',
            '#FAC70B',
        ],
      title: {
      text: 'Penyakit Bulan Ini',
      align: 'center'
    },
    labels: {{ labels_penyakit|safe }},
    responsive: [{
      breakpoint: 480,
      options: {
        legend: {
          position: 'bottom'
        }
      }
    }]
    };

    var penyakit_chart = new ApexCharts(document.querySelector("#penyakitPieChart"), opsi_penyakit);
    penyakit_chart.render();

    {% else %}
    // belum ada data penyakit
    {% endif %}

    {% if labels_obat_terbanyak and data_obat_terbanyak %}
    var opsi_top_obat = {
      chart: {
        type: 'bar'
      },
    title: {
      text: 'Obat Terbanyak Bulan Ini',
      align: 'center'
    },
    theme: {
        palette: 'palette7'
    },
    plotOptions: {
        bar: {
          borderRadius: 3,
          horizontal: true,
        }
      },
      series: [{
        name: 'obat',
        data: {{ data_obat_terbanyak|safe }}
      }],
      xaxis: {
        categories: {{ labels_obat_terbanyak|safe }}
      }
    }
    
    var top_obat_chart = new ApexCharts(document.querySelector("#obatBarChart"), opsi_top_obat);
    
    top_obat_chart.render();
    {% else %}
    //belum ada data obat terbanyak
    {% endif %}

  </script>
{% endblock %}
